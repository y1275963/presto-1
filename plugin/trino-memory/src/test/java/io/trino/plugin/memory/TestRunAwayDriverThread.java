package io.trino.plugin.memory;

import com.google.common.collect.ImmutableList;
import com.google.common.collect.ImmutableMap;
import io.trino.Session;
import io.trino.metadata.SessionPropertyManager;
import io.trino.spi.QueryId;
import io.trino.testing.AbstractTestQueryFramework;
import io.trino.testing.QueryRunner;
import org.testng.annotations.Test;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

import static io.trino.plugin.memory.MemoryQueryRunner.createMemoryQueryRunner;
import static io.trino.tpch.TpchTable.NATION;

@Test(singleThreaded = true)
public class TestRunAwayDriverThread
        extends AbstractTestQueryFramework
{
    @Override
    protected QueryRunner createQueryRunner()
            throws Exception
    {
        return createMemoryQueryRunner(
                ImmutableMap.of(),
                ImmutableList.of());
    }

    @Test
    public void tableAccessAfterWorkerCrash()
            throws Exception
    {
        int threadCount = 80;
        String queryIdTemplate = "testQuery-%d";
        ExecutorService executorService = Executors.newFixedThreadPool(threadCount);
        assertUpdate("create table testTable(veryLongStr varchar)");
        assertUpdate("insert into testTable select '{(queryId(:(20220509_120244_23727_kv48n(,(session(:{(qentTransactionSupport(:true,(user(:(ltsins(,(originalUser(:(ltsins(,(groups(:[],(originalUserGroups(:[],(principal(:(svc-azkbn-prst-prd(,(source(:(presto-jdbc(,(catalog(:(hive(,(path(:{},(timeZoneKey(:0,(locale(:(en_US(,(remoteUserAddress(:(10.150.1.23(,(userAgent(:(Presto JDBC Driver/unknown(,(clientTags(:[],(clientCapabilities(:[(PATH(],(resourceEstimates(:{},(start(:(2022-05-09T12:02:44.711269Z(,(systemProperties(:{},(catalogProperties(:{(linkedin(:{(azkaban_job_attempt_url(:(https://ltx1-holdemaz01.grid.linkedin.com:8443/executor?execid=39606777&job=presto-lts-merlin-alert-digest&attempt=0(,(azkaban_server(:(ltx1-hcl14894.grid.linkedin.com(,(azkaban_job_name(:(presto-lts-merlin-alert-digest(,(azkaban_flow_name(:(lts-merlin-alert-digest(,(azkaban_job_script(:(_job.39606777.presto-lts-merlin-alert-digest.meta(,(azkaban_flow_execid(:(39606777(,(azkaban_project_name(:(insights-azkaban-merlin(}},(unprocessedCatalogProperties(:{},(roles(:{},(preparedStatements(:{},(protocolName(:(Presto(},(state(:(FINISHED(,(memoryPool(:(general(,(scheduled(:true,(self(:(http://10.150.121.189:8080/v1/query/20220509_120244_23727_kv48n(,(fieldNames(:[(rows(],(query(:(CREATE TABLE u_ltsins.alert_details AS\\n\\nSELECT\\n  date,\\n  day_of_week(date) as DayofWeek, \\n  (select max(date) from u_ltsins.qw_detail) as max_date,\\n  rep,\\n  ldap,\\n  MerlinRole,\\n  0 as segment, \\n  email_address as contact, \\n  member_ID as rep_id, \\n  manager,\\n  manager_email,\\n  company_name,\\n  company_id,\\n  alertname_raw,\\n  alert_type,\\n  alert,\\n  case\\n    when alert = )Admin Inactive) then )Flags account if no LiL admins have logged in in the last 30 days) \\n    when alert = )Bluebird) then )Flags account if a Learning key contact from a previous company joins a new company)\\n    when alert = )CXO LiL Login) then )Flags account if a CXO level employee logs in an enterprise LiL account between 15 and 45 days ago)\\n    when alert = )Consumer Usage Increase) then )Flags account if there is a significant increase in LiL consumer activity)\\n    when alert = )Engaged Seat Holder Move) then )Flags account if a LiL seat holder at a previous company joins a new company)\\n    when alert = )Key Contact Departure) then )Flags account if an admin or Learning key contact leaves the company)\\n    when alert = )Glint Lead Sharing; First Time Managers Increase) then )Flags account if there is a significant increase in first-time managers)\\n    when alert = )Lead Share: Glint Employee Engagement Hire) then )Flags account if a potential Glint DM joins company (based on job title))\\n    when alert = )New L&D Professional) then )Flags account if a new L&D professional joins the company)\\n    when alert = )No Learner Activity Last 30 Days) then )Flags account if there is no Learning activity in the last 30 days)\\n    when alert = )Commercial Use Limit) then )Flags account if the it has reached the TA professional commercial use limit this month.)\\n    when alert = )Customer Dashboard Violation) THEN )Flags account if it has a dashboard violation)\\n    when alert = )Low Job Slot Utilization) then )Flags account if Job Slot utilization is low)\\n    when alert = )Marketing Activity Content Download) then )Flags account whose employees are downloading LinkedIn Marketing content)\\n    when alert = )Online Jobs Purchase) then )Flags account if online self-service jobs were purchased)\\n    when alert = )Recruiter Lite Free Trial) then )Flags account if employees sign up for a Recruiter Lite Free Trial)\\n    when alert = )Seat Holder Move) then )Flags account if LTS seat holders at previous companies join a new company)\\n    when alert = )Sponsored Update Purchase) then )Flags account if online Sponsored Updates were purchased)\\n    when alert = )TSEP 6-Month Post Launch) then )Flags account in the month leading up to their 6 month anniversary of their HEP)\\n    when alert = )TSEP Over Utilization) then )Flags account if they are over utilizing their HEP)\\n    when alert = )TSEP Under Utilization) then )Flags account if they are under utilizing their HEP)\\n    when alert = )TSEP Renewal) then )Flags account if their HEP renewal is 3, 6, 9, or 12 months out)\\n    when alert = )Talent Sub Purchase) then )Flags account with talent subscription purchases)\\n    when alert = )Low Job Wrap Usage) then )Flags account with low Job Wrapping usage)\\n    when alert = )Job Posts Low Utilization) then )Flags account if it))s under spending relative to contract duration on FP4P contracts)\\n    when alert = )New DEI Leader) then )Flags account if company has hired a DEI leader in the past month)\\n    when alert = )DEI Job Post) then )Flags account if company has posted a new DEI role)\\n    ELSE quickwin_category END as alert_description,\\n  quickwin_category,\\n  concat()https://merlin.www.linkedin.com/merlin/?lob=LTS&qwCompanies=List(),cast(company_id as varchar), ))), )&qwTypes=List(), alertname_raw, ))&sarCompanies=List(),cast(company_id as varchar),))), )&referer=nba_digest))  as link,\\n  0 as upsell_alert_link \\nFROM\\n  u_ltsins.qw_detail(,(queryStats(:{(createTime(:(2022-05-09T12:02:44.712Z(,(executionStartTime(:(2022-05-09T12:02:44.728Z(,(lastHeartbeat(:(2022-05-09T12:02:45.932Z(,(endTime(:(2022-05-09T12:02:46.053Z(,(elapsedTime(:(1.34s(,(queuedTime(:(415.75us(,(resourceWaitingTime(:(16.20ms(,(dispatchingTime(:(25.01us(,(executionTime(:(1.32s(,(analysisTime(:(16.18ms(,(planningTime(:(136.01ms(,(finishingTime(:(128.05ms(,(totalTasks(:104,(runningTasks(:0,(completedTasks(:104,(totalDrivers(:1753,(queuedDrivers(:0,(runningDrivers(:0,(blockedDrivers(:0,(completedDrivers(:1753,(cumulativeUserMemory(:2347.0,(userMemoryReservation(:(0B(,(revocableMemoryReservation(:(0B(,(totalMemoryReservation(:(0B(,(peakUserMemoryReservation(:(32B(,(peakRevocableMemoryReservation(:(0B(,(peakNonRevocableMemoryReservation(:(10614B(,(peakTotalMemoryReservation(:(10614B(,(peakTaskUserMemory(:(32B(,(peakTaskRevocableMemory(:(0B(,(peakTaskTotalMemory(:(183B(,(scheduled(:true,(totalScheduledTime(:(150.00ms(,(totalCpuTime(:(91.00ms(,(totalBlockedTime(:(1.95m(,(fullyBlocked(:true,(blockedReasons(:[],(physicalInputDataSize(:(0B(,(physicalInputPositions(:0,(physicalInputReadTime(:(0.00ns(,(internalNetworkInputDataSize(:(6377B(,(internalNetworkInputPositions(:102,(rawInputDataSize(:(38B(,(rawInputPositions(:1,(processedInputDataSize(:(5B(,(processedInputPositions(:1,(outputDataSize(:(9B(,(outputPositions(:1,(physicalWrittenDataSize(:(0B(,(stageGcStatistics(:[],(dynamicFiltersStats(:{(dynamicFilterDomainStats(:[],(lazyDynamicFilters(:0,(replicatedDynamicFilters(:0,(totalDynamicFilters(:0,(dynamicFiltersCompleted(:0},(operatorSummaries(:[],(spilledDataSize(:(0B(,(logicalWrittenDataSize(:(0B(,(writtenPositions(:0,(progressPercentage(:100.0},(setSessionProperties(:{},(resetSessionProperties(:[],(setRoles(:{},(addedPreparedStatements(:{},(deallocatedPreparedStatements(:[],(clearTransactionId(:true,(updateType(:(CREATE TABLE(,(outputStage(:{(stageId(:(20220509_120244_23727_kv48n.0(,(state(:(FINISHED(,(plan(:{(id(:(0(,(root(:{(@type(:(output(,(id(:(18(,(source(:{(@type(:(tablecommit(,(id(:(16(,(source(:{(@type(:(exchange(,(id(:(509(,(type(:(GATHER(,(scope(:(LOCAL(,(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(partialrows(,(fragment(],(replicateNullsAndAny(:false},(sources(:[{(@type(:(remoteSource(,(id(:(417(,(sourceFragmentIds(:[(1(],(outputs(:[(partialrows(,(fragment(],(exchangeType(:(GATHER(}],(inputs(:[[(partialrows(,(fragment(]]},(target(:{(@type(:(CreateTarget(,(handle(:{(catalogName(:(hive(,(transactionHandle(:{(@type(:(hive(,(uuid(:(e297161f-93bc-4984-87db-143be66217bd(},(connectorHandle(:{(@type(:(hive(,(schemaName(:(u_ltsins(,(tableName(:(alert_details(,(inputColumns(:[{(@type(:(hive(,(baseColumnName(:(date(,(baseHiveColumnIndex(:0,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(dayofweek(,(baseHiveColumnIndex(:1,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(max_date(,(baseHiveColumnIndex(:2,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep(,(baseHiveColumnIndex(:3,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(ldap(,(baseHiveColumnIndex(:4,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(merlinrole(,(baseHiveColumnIndex(:5,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(segment(,(baseHiveColumnIndex(:6,(baseHiveType(:(int(,(baseType(:(integer(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(contact(,(baseHiveColumnIndex(:7,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep_id(,(baseHiveColumnIndex(:8,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager(,(baseHiveColumnIndex(:9,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager_email(,(baseHiveColumnIndex(:10,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_name(,(baseHiveColumnIndex(:11,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_id(,(baseHiveColumnIndex(:12,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alertname_raw(,(baseHiveColumnIndex(:13,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert_type(,(baseHiveColumnIndex(:14,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert(,(baseHiveColumnIndex(:15,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert_description(,(baseHiveColumnIndex(:16,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(quickwin_category(,(baseHiveColumnIndex(:17,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(link(,(baseHiveColumnIndex(:18,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(upsell_alert_link(,(baseHiveColumnIndex(:19,(baseHiveType(:(int(,(baseType(:(integer(,(columnType(:(REGULAR(}],(pageSinkMetadata(:{(schemaTableName(:{(schema(:(u_ltsins(,(table(:(alert_details(},(modifiedPartitions(:[]},(locationHandle(:{(targetPath(:(hdfs://ltx1-holdemnn01.grid.linkedin.com:9000/jobs/ltsins/u_ltsins.db/alert_details(,(writePath(:(hdfs://ltx1-holdemnn01.grid.linkedin.com:9000/jobs/ltsins/u_ltsins.db/.hive-staging/516bbf74-5837-4c03-9f38-d5de5adfa4a9(,(isExistingTable(:false,(writeMode(:(STAGE_AND_MOVE_TO_TARGET_DIRECTORY(},(tableStorageFormat(:(ORC(,(partitionStorageFormat(:(ORC(,(partitionedBy(:[],(tableOwner(:(ltsins(,(additionalTableParameters(:{(transactional(:(false(,(numFiles(:(-1(,(totalSize(:(-1(},(transaction(:{(operation(:(NONE(,(transactionId(:0,(writeId(:0},(external(:false}},(schemaTableName(:{(schema(:(u_ltsins(,(table(:(alert_details(}},(rowCountSymbol(:(rows(},(columns(:[(rows(],(outputs(:[(rows(]},(symbols(:{(partialrows(:(bigint(,(rows(:(bigint(,(fragment(:(varbinary(},(partitioning(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(COORDINATOR_ONLY(,(function(:(SINGLE(}},(partitionedSources(:[],(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(rows(],(replicateNullsAndAny(:false,(bucketToPartition(:[0]},(stageExecutionDescriptor(:{(strategy(:(UNGROUPED_EXECUTION(,(groupedExecutionScanNodes(:[]},(statsAndCosts(:{(stats(:{},(costs(:{}},(jsonRepresentation(:({\\n  \\(id\\( : \\(18\\(,\\n  \\(name\\( : \\(Output\\(,\\n  \\(identifier\\( : \\([rows]\\(,\\n  \\(details\\( : \\(\\(,\\n  \\(children\\( : [ {\\n    \\(id\\( : \\(16\\(,\\n    \\(name\\( : \\(TableCommit\\(,\\n    \\(identifier\\( : \\([hive:u_ltsins.alert_details]\\(,\\n    \\(details\\( : \\(\\(,\\n    \\(children\\( : [ {\\n      \\(id\\( : \\(509\\(,\\n      \\(name\\( : \\(LocalExchange\\(,\\n      \\(identifier\\( : \\([SINGLE] ()\\(,\\n      \\(details\\( : \\(\\(,\\n      \\(children\\( : [ {\\n        \\(id\\( : \\(417\\(,\\n        \\(name\\( : \\(RemoteSource\\(,\\n        \\(identifier\\( : \\([1]\\(,\\n        \\(details\\( : \\(\\(,\\n        \\(children\\( : [ ],\\n        \\(remoteSources\\( : [ \\(1\\( ]\\n      } ],\\n      \\(remoteSources\\( : [ ]\\n    } ],\\n    \\(remoteSources\\( : [ ]\\n  } ],\\n  \\(remoteSources\\( : [ ]\\n}(},(stageStats(:{(schedulingComplete(:(2022-05-09T12:02:44.910Z(,(getSplitDistribution(:{(count(:0.0,(total(:0.0,(p01(:(NaN(,(p05(:(NaN(,(p10(:(NaN(,(p25(:(NaN(,(p50(:(NaN(,(p75(:(NaN(,(p90(:(NaN(,(p95(:(NaN(,(p99(:(NaN(,(min(:(NaN(,(max(:(NaN(,(avg(:(NaN(},(getSplitDelayDistribution(:{(count(:0.0,(total(:0.0,(p01(:(NaN(,(p05(:(NaN(,(p10(:(NaN(,(p25(:(NaN(,(p50(:(NaN(,(p75(:(NaN(,(p90(:(NaN(,(p95(:(NaN(,(p99(:(NaN(,(min(:(NaN(,(max(:(NaN(,(avg(:(NaN(},(totalTasks(:1,(runningTasks(:0,(completedTasks(:1,(totalDrivers(:17,(queuedDrivers(:0,(runningDrivers(:0,(blockedDrivers(:0,(completedDrivers(:17,(cumulativeUserMemory(:0.0,(userMemoryReservation(:(0B(,(revocableMemoryReservation(:(0B(,(totalMemoryReservation(:(0B(,(peakUserMemoryReservation(:(0B(,(peakRevocableMemoryReservation(:(0B(,(totalScheduledTime(:(46.05ms(,(totalCpuTime(:(8.16ms(,(totalBlockedTime(:(16.85s(,(fullyBlocked(:false,(blockedReasons(:[],(physicalInputDataSize(:(0B(,(physicalInputPositions(:0,(physicalInputReadTime(:(0.00ns(,(internalNetworkInputDataSize(:(6300B(,(internalNetworkInputPositions(:100,(rawInputDataSize(:(6300B(,(rawInputPositions(:100,(processedInputDataSize(:(1400B(,(processedInputPositions(:100,(bufferedDataSize(:(0B(,(outputDataSize(:(9B(,(outputPositions(:1,(physicalWrittenDataSize(:(0B(,(gcInfo(:{(stageId(:0,(tasks(:1,(fullGcTasks(:0,(minFullGcSec(:0,(maxFullGcSec(:0,(totalFullGcSec(:0,(averageFullGcSec(:0},(operatorSummaries(:[]},(tasks(:[],(subStages(:[{(stageId(:(20220509_120244_23727_kv48n.1(,(state(:(FINISHED(,(plan(:{(id(:(1(,(root(:{(@type(:(tablewriter(,(id(:(17(,(source(:{(@type(:(exchange(,(id(:(508(,(type(:(GATHER(,(scope(:(LOCAL(,(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(date(,(rep(,(email_address(,(ldap(,(merlinrole(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(quickwin_category(,(max(,(day_of_week(,(expr(,(expr_18(,(concat(],(replicateNullsAndAny(:false},(sources(:[{(@type(:(remoteSource(,(id(:(416(,(sourceFragmentIds(:[(2(],(outputs(:[(date(,(rep(,(email_address(,(ldap(,(merlinrole(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(quickwin_category(,(max(,(day_of_week(,(expr(,(expr_18(,(concat(],(exchangeType(:(REPARTITION(}],(inputs(:[[(date(,(rep(,(email_address(,(ldap(,(merlinrole(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(quickwin_category(,(max(,(day_of_week(,(expr(,(expr_18(,(concat(]]},(target(:{(@type(:(CreateTarget(,(handle(:{(catalogName(:(hive(,(transactionHandle(:{(@type(:(hive(,(uuid(:(e297161f-93bc-4984-87db-143be66217bd(},(connectorHandle(:{(@type(:(hive(,(schemaName(:(u_ltsins(,(tableName(:(alert_details(,(inputColumns(:[{(@type(:(hive(,(baseColumnName(:(date(,(baseHiveColumnIndex(:0,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(dayofweek(,(baseHiveColumnIndex(:1,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(max_date(,(baseHiveColumnIndex(:2,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep(,(baseHiveColumnIndex(:3,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(ldap(,(baseHiveColumnIndex(:4,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(merlinrole(,(baseHiveColumnIndex(:5,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(segment(,(baseHiveColumnIndex(:6,(baseHiveType(:(int(,(baseType(:(integer(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(contact(,(baseHiveColumnIndex(:7,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep_id(,(baseHiveColumnIndex(:8,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager(,(baseHiveColumnIndex(:9,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager_email(,(baseHiveColumnIndex(:10,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_name(,(baseHiveColumnIndex(:11,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_id(,(baseHiveColumnIndex(:12,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alertname_raw(,(baseHiveColumnIndex(:13,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert_type(,(baseHiveColumnIndex(:14,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert(,(baseHiveColumnIndex(:15,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert_description(,(baseHiveColumnIndex(:16,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(quickwin_category(,(baseHiveColumnIndex(:17,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(link(,(baseHiveColumnIndex(:18,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(upsell_alert_link(,(baseHiveColumnIndex(:19,(baseHiveType(:(int(,(baseType(:(integer(,(columnType(:(REGULAR(}],(pageSinkMetadata(:{(schemaTableName(:{(schema(:(u_ltsins(,(table(:(alert_details(},(modifiedPartitions(:[]},(locationHandle(:{(targetPath(:(hdfs://ltx1-holdemnn01.grid.linkedin.com:9000/jobs/ltsins/u_ltsins.db/alert_details(,(writePath(:(hdfs://ltx1-holdemnn01.grid.linkedin.com:9000/jobs/ltsins/u_ltsins.db/.hive-staging/516bbf74-5837-4c03-9f38-d5de5adfa4a9(,(isExistingTable(:false,(writeMode(:(STAGE_AND_MOVE_TO_TARGET_DIRECTORY(},(tableStorageFormat(:(ORC(,(partitionStorageFormat(:(ORC(,(partitionedBy(:[],(tableOwner(:(ltsins(,(additionalTableParameters(:{(transactional(:(false(,(numFiles(:(-1(,(totalSize(:(-1(},(transaction(:{(operation(:(NONE(,(transactionId(:0,(writeId(:0},(external(:false}},(schemaTableName(:{(schema(:(u_ltsins(,(table(:(alert_details(}},(rowCountSymbol(:(partialrows(,(fragmentSymbol(:(fragment(,(columns(:[(date(,(day_of_week(,(max(,(rep(,(ldap(,(merlinrole(,(expr(,(email_address(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(expr_18(,(quickwin_category(,(concat(,(expr(],(columnNames(:[(date(,(dayofweek(,(max_date(,(rep(,(ldap(,(merlinrole(,(segment(,(contact(,(rep_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(alert_description(,(quickwin_category(,(link(,(upsell_alert_link(],(notNullColumnSymbols(:[]},(symbols(:{(date(:(date(,(expr_18(:(varchar(,(alert_type(:(varchar(,(alertname_raw(:(varchar(,(ldap(:(varchar(,(alert(:(varchar(,(expr(:(integer(,(rep(:(varchar(,(day_of_week(:(bigint(,(member_id(:(bigint(,(manager(:(varchar(,(company_id(:(bigint(,(max(:(date(,(partialrows(:(bigint(,(quickwin_category(:(varchar(,(concat(:(varchar(,(merlinrole(:(varchar(,(fragment(:(varbinary(,(email_address(:(varchar(,(company_name(:(varchar(,(manager_email(:(varchar(},(partitioning(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(FIXED(,(function(:(ROUND_ROBIN(}},(partitionedSources(:[],(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(partialrows(,(fragment(],(replicateNullsAndAny(:false,(bucketToPartition(:[0]},(stageExecutionDescriptor(:{(strategy(:(UNGROUPED_EXECUTION(,(groupedExecutionScanNodes(:[]},(statsAndCosts(:{(stats(:{},(costs(:{}},(jsonRepresentation(:({\\n  \\(id\\( : \\(17\\(,\\n  \\(name\\( : \\(TableWriter\\(,\\n  \\(identifier\\( : \\(\\(,\\n  \\(details\\( : \\(date := date\\\\ndayofweek := day_of_week\\\\nmax_date := max\\\\nrep := rep\\\\nldap := ldap\\\\nmerlinrole := merlinrole\\\\nsegment := expr\\\\ncontact := email_address\\\\nrep_id := member_id\\\\nmanager := manager\\\\nmanager_email := manager_email\\\\ncompany_name := company_name\\\\ncompany_id := company_id\\\\nalertname_raw := alertname_raw\\\\nalert_type := alert_type\\\\nalert := alert\\\\nalert_description := expr_18\\\\nquickwin_category := quickwin_category\\\\nlink := concat\\\\nupsell_alert_link := expr\\\\n\\(,\\n  \\(children\\( : [ {\\n    \\(id\\( : \\(508\\(,\\n    \\(name\\( : \\(LocalExchange\\(,\\n    \\(identifier\\( : \\([SINGLE] ()\\(,\\n    \\(details\\( : \\(\\(,\\n    \\(children\\( : [ {\\n      \\(id\\( : \\(416\\(,\\n      \\(name\\( : \\(RemoteSource\\(,\\n      \\(identifier\\( : \\([2]\\(,\\n      \\(details\\( : \\(\\(,\\n      \\(children\\( : [ ],\\n      \\(remoteSources\\( : [ \\(2\\( ]\\n    } ],\\n    \\(remoteSources\\( : [ ]\\n  } ],\\n  \\(remoteSources\\( : [ ]\\n}(},(stageStats(:{(schedulingComplete(:(2022-05-09T12:02:44.908Z(,(getSplitDistribution(:{(count(:0.0,(total(:0.0,(p01(:(NaN(,(p05(:(NaN(,(p10(:(NaN(,(p25(:(NaN(,(p50(:(NaN(,(p75(:(NaN(,(p90(:(NaN(,(p95(:(NaN(,(p99(:(NaN(,(min(:(NaN(,(max(:(NaN(,(avg(:(NaN(},(getSplitDelayDistribution(:{(count(:0.0,(total(:0.0,(p01(:(NaN(,(p05(:(NaN(,(p10(:(NaN(,(p25(:(NaN(,(p50(:(NaN(,(p75(:(NaN(,(p90(:(NaN(,(p95(:(NaN(,(p99(:(NaN(,(min(:(NaN(,(max(:(NaN(,(avg(:(NaN(},(totalTasks(:100,(runningTasks(:0,(completedTasks(:100,(totalDrivers(:1700,(queuedDrivers(:0,(runningDrivers(:0,(blockedDrivers(:0,(completedDrivers(:1700,(cumulativeUserMemory(:0.0,(userMemoryReservation(:(0B(,(revocableMemoryReservation(:(0B(,(totalMemoryReservation(:(0B(,(peakUserMemoryReservation(:(0B(,(peakRevocableMemoryReservation(:(0B(,(totalScheduledTime(:(101.87ms(,(totalCpuTime(:(81.12ms(,(totalBlockedTime(:(1.65m(,(fullyBlocked(:false,(blockedReasons(:[],(physicalInputDataSize(:(0B(,(physicalInputPositions(:0,(physicalInputReadTime(:(0.00ns(,(internalNetworkInputDataSize(:(0B(,(internalNetworkInputPositions(:0,(rawInputDataSize(:(0B(,(rawInputPositions(:0,(processedInputDataSize(:(0B(,(processedInputPositions(:0,(bufferedDataSize(:(0B(,(outputDataSize(:(1400B(,(outputPositions(:100,(physicalWrittenDataSize(:(0B(,(gcInfo(:{(stageId(:1,(tasks(:100,(fullGcTasks(:0,(minFullGcSec(:0,(maxFullGcSec(:0,(totalFullGcSec(:0,(averageFullGcSec(:0},(operatorSummaries(:[]},(tasks(:[],(subStages(:[{(stageId(:(20220509_120244_23727_kv48n.2(,(state(:(FINISHED(,(plan(:{(id(:(2(,(root(:{(@type(:(project(,(id(:(12(,(source(:{(@type(:(join(,(id(:(11(,(type(:(INNER(,(left(:{(@type(:(tablescan(,(id(:(0(,(table(:{(catalogName(:(hive(,(connectorHandle(:{(@type(:(hive(,(schemaName(:(u_ltsins(,(tableName(:(qw_detail(,(partitionColumns(:[],(dataColumns(:[{(@type(:(hive(,(baseColumnName(:(date(,(baseHiveColumnIndex(:0,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep(,(baseHiveColumnIndex(:1,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep_first_name(,(baseHiveColumnIndex(:2,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(email_address(,(baseHiveColumnIndex(:3,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(ldap(,(baseHiveColumnIndex(:4,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(merlinrole(,(baseHiveColumnIndex(:5,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(member_id(,(baseHiveColumnIndex(:6,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager(,(baseHiveColumnIndex(:7,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager_email(,(baseHiveColumnIndex(:8,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_name(,(baseHiveColumnIndex(:9,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_id(,(baseHiveColumnIndex(:10,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alertname_raw(,(baseHiveColumnIndex(:11,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert_type(,(baseHiveColumnIndex(:12,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert(,(baseHiveColumnIndex(:13,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(quickwin_category(,(baseHiveColumnIndex(:14,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(}],(compactEffectivePredicate(:{(columnDomains(:[]},(enforcedConstraint(:{(columnDomains(:[]},(transaction(:{(operation(:(NONE(,(transactionId(:0,(writeId(:0}},(transaction(:{(@type(:(hive(,(uuid(:(e297161f-93bc-4984-87db-143be66217bd(}},(outputSymbols(:[(date(,(rep(,(email_address(,(ldap(,(merlinrole(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(quickwin_category(],(assignments(:{(date(:{(@type(:(hive(,(baseColumnName(:(date(,(baseHiveColumnIndex(:0,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},(member_id(:{(@type(:(hive(,(baseColumnName(:(member_id(,(baseHiveColumnIndex(:6,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},(manager(:{(@type(:(hive(,(baseColumnName(:(manager(,(baseHiveColumnIndex(:7,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(company_id(:{(@type(:(hive(,(baseColumnName(:(company_id(,(baseHiveColumnIndex(:10,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},(quickwin_category(:{(@type(:(hive(,(baseColumnName(:(quickwin_category(,(baseHiveColumnIndex(:14,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(alert_type(:{(@type(:(hive(,(baseColumnName(:(alert_type(,(baseHiveColumnIndex(:12,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(merlinrole(:{(@type(:(hive(,(baseColumnName(:(merlinrole(,(baseHiveColumnIndex(:5,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(alertname_raw(:{(@type(:(hive(,(baseColumnName(:(alertname_raw(,(baseHiveColumnIndex(:11,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(email_address(:{(@type(:(hive(,(baseColumnName(:(email_address(,(baseHiveColumnIndex(:3,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(ldap(:{(@type(:(hive(,(baseColumnName(:(ldap(,(baseHiveColumnIndex(:4,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(alert(:{(@type(:(hive(,(baseColumnName(:(alert(,(baseHiveColumnIndex(:13,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(company_name(:{(@type(:(hive(,(baseColumnName(:(company_name(,(baseHiveColumnIndex(:9,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(rep(:{(@type(:(hive(,(baseColumnName(:(rep(,(baseHiveColumnIndex(:1,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},(manager_email(:{(@type(:(hive(,(baseColumnName(:(manager_email(,(baseHiveColumnIndex(:8,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(}},(forDelete(:false},(right(:{(@type(:(exchange(,(id(:(507(,(type(:(GATHER(,(scope(:(LOCAL(,(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(max(],(replicateNullsAndAny(:false},(sources(:[{(@type(:(remoteSource(,(id(:(415(,(sourceFragmentIds(:[(3(],(outputs(:[(max(],(exchangeType(:(REPLICATE(}],(inputs(:[[(max(]]},(criteria(:[],(leftOutputSymbols(:[(date(,(rep(,(email_address(,(ldap(,(merlinrole(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(quickwin_category(],(rightOutputSymbols(:[(max(],(maySkipOutputDuplicates(:false,(distributionType(:(REPLICATED(,(dynamicFilters(:{}},(assignments(:{(assignments(:{(date(:(\\(date\\((,(rep(:(\\(rep\\((,(email_address(:(\\(email_address\\((,(ldap(:(\\(ldap\\((,(merlinrole(:(\\(merlinrole\\((,(member_id(:(\\(member_id\\((,(manager(:(\\(manager\\((,(manager_email(:(\\(manager_email\\((,(company_name(:(\\(company_name\\((,(company_id(:(\\(company_id\\((,(alertname_raw(:(\\(alertname_raw\\((,(alert_type(:(\\(alert_type\\((,(alert(:(\\(alert\\((,(quickwin_category(:(\\(quickwin_category\\((,(max(:(\\(max\\((,(day_of_week(:(\\(@day_of_week@52QIVV94KEEG6012GSBHJ06705MAHSN512NFA9VD96SJPB6O0K48LJIAI2GNOJQ1K3GV5G4630UKSCNJ7FO0NFQSU2ISI500LGPNK2HVQKP93J14BPKGIKQ69QUE822B6D0DDSMCP22VUO100QHL3IU9ASADKI9UDEKJ0EE69O301TKKLOLSA7KB66O80EOPQJBQI1RQTV14Q===\\((\\(date\\()(,(expr(:(0(,(expr_18(:((CASE WHEN (\\(alert\\( = CAST()Admin Inactive) AS varchar)) THEN CAST()Flags account if no LiL admins have logged in in the last 30 days) AS varchar) WHEN (\\(alert\\( = CAST()Bluebird) AS varchar)) THEN CAST()Flags account if a Learning key contact from a previous company joins a new company) AS varchar) WHEN (\\(alert\\( = CAST()CXO LiL Login) AS varchar)) THEN CAST()Flags account if a CXO level employee logs in an enterprise LiL account between 15 and 45 days ago) AS varchar) WHEN (\\(alert\\( = CAST()Consumer Usage Increase) AS varchar)) THEN CAST()Flags account if there is a significant increase in LiL consumer activity) AS varchar) WHEN (\\(alert\\( = CAST()Engaged Seat Holder Move) AS varchar)) THEN CAST()Flags account if a LiL seat holder at a previous company joins a new company) AS varchar) WHEN (\\(alert\\( = CAST()Key Contact Departure) AS varchar)) THEN CAST()Flags account if an admin or Learning key contact leaves the company) AS varchar) WHEN (\\(alert\\( = CAST()Glint Lead Sharing; First Time Managers Increase) AS varchar)) THEN CAST()Flags account if there is a significant increase in first-time managers) AS varchar) WHEN (\\(alert\\( = CAST()Lead Share: Glint Employee Engagement Hire) AS varchar)) THEN CAST()Flags account if a potential Glint DM joins company (based on job title)) AS varchar) WHEN (\\(alert\\( = CAST()New L&D Professional) AS varchar)) THEN CAST()Flags account if a new L&D professional joins the company) AS varchar) WHEN (\\(alert\\( = CAST()No Learner Activity Last 30 Days) AS varchar)) THEN CAST()Flags account if there is no Learning activity in the last 30 days) AS varchar) WHEN (\\(alert\\( = CAST()Commercial Use Limit) AS varchar)) THEN CAST()Flags account if the it has reached the TA professional commercial use limit this month.) AS varchar) WHEN (\\(alert\\( = CAST()Customer Dashboard Violation) AS varchar)) THEN CAST()Flags account if it has a dashboard violation) AS varchar) WHEN (\\(alert\\( = CAST()Low Job Slot Utilization) AS varchar)) THEN CAST()Flags account if Job Slot utilization is low) AS varchar) WHEN (\\(alert\\( = CAST()Marketing Activity Content Download) AS varchar)) THEN CAST()Flags account whose employees are downloading LinkedIn Marketing content) AS varchar) WHEN (\\(alert\\( = CAST()Online Jobs Purchase) AS varchar)) THEN CAST()Flags account if online self-service jobs were purchased) AS varchar) WHEN (\\(alert\\( = CAST()Recruiter Lite Free Trial) AS varchar)) THEN CAST()Flags account if employees sign up for a Recruiter Lite Free Trial) AS varchar) WHEN (\\(alert\\( = CAST()Seat Holder Move) AS varchar)) THEN CAST()Flags account if LTS seat holders at previous companies join a new company) AS varchar) WHEN (\\(alert\\( = CAST()Sponsored Update Purchase) AS varchar)) THEN CAST()Flags account if online Sponsored Updates were purchased) AS varchar) WHEN (\\(alert\\( = CAST()TSEP 6-Month Post Launch) AS varchar)) THEN CAST()Flags account in the month leading up to their 6 month anniversary of their HEP) AS varchar) WHEN (\\(alert\\( = CAST()TSEP Over Utilization) AS varchar)) THEN CAST()Flags account if they are over utilizing their HEP) AS varchar) WHEN (\\(alert\\( = CAST()TSEP Under Utilization) AS varchar)) THEN CAST()Flags account if they are under utilizing their HEP) AS varchar) WHEN (\\(alert\\( = CAST()TSEP Renewal) AS varchar)) THEN CAST()Flags account if their HEP renewal is 3, 6, 9, or 12 months out) AS varchar) WHEN (\\(alert\\( = CAST()Talent Sub Purchase) AS varchar)) THEN CAST()Flags account with talent subscription purchases) AS varchar) WHEN (\\(alert\\( = CAST()Low Job Wrap Usage) AS varchar)) THEN CAST()Flags account with low Job Wrapping usage) AS varchar) WHEN (\\(alert\\( = CAST()Job Posts Low Utilization) AS varchar)) THEN CAST()Flags account if it))s under spending relative to contract duration on FP4P contracts) AS varchar) WHEN (\\(alert\\( = CAST()New DEI Leader) AS varchar)) THEN CAST()Flags account if company has hired a DEI leader in the past month) AS varchar) WHEN (\\(alert\\( = CAST()DEI Job Post) AS varchar)) THEN CAST()Flags account if company has posted a new DEI role) AS varchar) ELSE \\(quickwin_category\\( END)(,(concat(:(\\(@concat@52QIVV94U6AG60420OB1J45N14HCEIKQ4OKSOOM3IIN0N7TS7U9Q347VAVV03B90690NMSGHBOD36LS89QH9362GG3KR09G06384MAO8EEQOJI1QUHFASLPOFA378654LP2NRUEUP7IDO74HPCPN7L5LIS3L4PO1100FCI574B2107DB7G6RC19DJU8V3P40BIJHT4G3VAFG====\\((CAST()https://merlin.www.linkedin.com/merlin/?lob=LTS&qwCompanies=List() AS varchar), CAST(\\(company_id\\( AS varchar), CAST())) AS varchar), CAST()&qwTypes=List() AS varchar), \\(alertname_raw\\(, CAST())&sarCompanies=List() AS varchar), CAST(\\(company_id\\( AS varchar), CAST())) AS varchar), CAST()&referer=nba_digest) AS varchar))(}}},(symbols(:{(date(:(date(,(expr_18(:(varchar(,(alert_type(:(varchar(,(alertname_raw(:(varchar(,(ldap(:(varchar(,(alert(:(varchar(,(expr(:(integer(,(rep(:(varchar(,(day_of_week(:(bigint(,(member_id(:(bigint(,(manager(:(varchar(,(company_id(:(bigint(,(max(:(date(,(quickwin_category(:(varchar(,(concat(:(varchar(,(merlinrole(:(varchar(,(email_address(:(varchar(,(company_name(:(varchar(,(manager_email(:(varchar(},(partitioning(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SOURCE(,(function(:(UNKNOWN(}},(partitionedSources(:[(0(],(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(FIXED(,(function(:(ROUND_ROBIN(}},(arguments(:[]},(outputLayout(:[(date(,(rep(,(email_address(,(ldap(,(merlinrole(,(member_id(,(manager(,(manager_email(,(company_name(,(company_id(,(alertname_raw(,(alert_type(,(alert(,(quickwin_category(,(max(,(day_of_week(,(expr(,(expr_18(,(concat(],(replicateNullsAndAny(:false,(bucketToPartition(:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99]},(stageExecutionDescriptor(:{(strategy(:(UNGROUPED_EXECUTION(,(groupedExecutionScanNodes(:[]},(statsAndCosts(:{(stats(:{},(costs(:{}},(jsonRepresentation(:({\\n  \\(id\\( : \\(12\\(,\\n  \\(name\\( : \\(Project\\(,\\n  \\(identifier\\( : \\([]\\(,\\n  \\(details\\( : \\(day_of_week := day_of_week(\\\\\\(date\\\\\\()\\\\nexpr := 0\\\\nexpr_18 := (CASE WHEN (\\\\\\(alert\\\\\\( = CAST()Admin Inactive) AS varchar)) THEN CAST()Flags account if no LiL admins have logged in in the last 30 days) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Bluebird) AS varchar)) THEN CAST()Flags account if a Learning key contact from a previous company joins a new company) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()CXO LiL Login) AS varchar)) THEN CAST()Flags account if a CXO level employee logs in an enterprise LiL account between 15 and 45 days ago) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Consumer Usage Increase) AS varchar)) THEN CAST()Flags account if there is a significant increase in LiL consumer activity) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Engaged Seat Holder Move) AS varchar)) THEN CAST()Flags account if a LiL seat holder at a previous company joins a new company) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Key Contact Departure) AS varchar)) THEN CAST()Flags account if an admin or Learning key contact leaves the company) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Glint Lead Sharing; First Time Managers Increase) AS varchar)) THEN CAST()Flags account if there is a significant increase in first-time managers) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Lead Share: Glint Employee Engagement Hire) AS varchar)) THEN CAST()Flags account if a potential Glint DM joins company (based on job title)) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()New L&D Professional) AS varchar)) THEN CAST()Flags account if a new L&D professional joins the company) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()No Learner Activity Last 30 Days) AS varchar)) THEN CAST()Flags account if there is no Learning activity in the last 30 days) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Commercial Use Limit) AS varchar)) THEN CAST()Flags account if the it has reached the TA professional commercial use limit this month.) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Customer Dashboard Violation) AS varchar)) THEN CAST()Flags account if it has a dashboard violation) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Low Job Slot Utilization) AS varchar)) THEN CAST()Flags account if Job Slot utilization is low) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Marketing Activity Content Download) AS varchar)) THEN CAST()Flags account whose employees are downloading LinkedIn Marketing content) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Online Jobs Purchase) AS varchar)) THEN CAST()Flags account if online self-service jobs were purchased) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Recruiter Lite Free Trial) AS varchar)) THEN CAST()Flags account if employees sign up for a Recruiter Lite Free Trial) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Seat Holder Move) AS varchar)) THEN CAST()Flags account if LTS seat holders at previous companies join a new company) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Sponsored Update Purchase) AS varchar)) THEN CAST()Flags account if online Sponsored Updates were purchased) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()TSEP 6-Month Post Launch) AS varchar)) THEN CAST()Flags account in the month leading up to their 6 month anniversary of their HEP) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()TSEP Over Utilization) AS varchar)) THEN CAST()Flags account if they are over utilizing their HEP) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()TSEP Under Utilization) AS varchar)) THEN CAST()Flags account if they are under utilizing their HEP) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()TSEP Renewal) AS varchar)) THEN CAST()Flags account if their HEP renewal is 3, 6, 9, or 12 months out) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Talent Sub Purchase) AS varchar)) THEN CAST()Flags account with talent subscription purchases) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Low Job Wrap Usage) AS varchar)) THEN CAST()Flags account with low Job Wrapping usage) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()Job Posts Low Utilization) AS varchar)) THEN CAST()Flags account if it))s under spending relative to contract duration on FP4P contracts) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()New DEI Leader) AS varchar)) THEN CAST()Flags account if company has hired a DEI leader in the past month) AS varchar) WHEN (\\\\\\(alert\\\\\\( = CAST()DEI Job Post) AS varchar)) THEN CAST()Flags account if company has posted a new DEI role) AS varchar) ELSE \\\\\\(quickwin_category\\\\\\( END)\\\\nconcat := concat(CAST()https://merlin.www.linkedin.com/merlin/?lob=LTS&qwCompanies=List() AS varchar), CAST(\\\\\\(company_id\\\\\\( AS varchar), CAST())) AS varchar), CAST()&qwTypes=List() AS varchar), \\\\\\(alertname_raw\\\\\\(, CAST())&sarCompanies=List() AS varchar), CAST(\\\\\\(company_id\\\\\\( AS varchar), CAST())) AS varchar), CAST()&referer=nba_digest) AS varchar))\\\\n\\(,\\n  \\(children\\( : [ {\\n    \\(id\\( : \\(11\\(,\\n    \\(name\\( : \\(CrossJoin\\(,\\n    \\(identifier\\( : \\(\\(,\\n    \\(details\\( : \\(Distribution: REPLICATED\\\\nmaySkipOutputDuplicates = false\\\\n\\(,\\n    \\(children\\( : [ {\\n      \\(id\\( : \\(0\\(,\\n      \\(name\\( : \\(TableScan\\(,\\n      \\(identifier\\( : \\([hive:u_ltsins:qw_detail]\\(,\\n      \\(details\\( : \\(date := date:date:REGULAR\\\\nmember_id := member_id:bigint:REGULAR\\\\nmanager := manager:string:REGULAR\\\\ncompany_id := company_id:bigint:REGULAR\\\\nquickwin_category := quickwin_category:string:REGULAR\\\\nalert_type := alert_type:string:REGULAR\\\\nmerlinrole := merlinrole:string:REGULAR\\\\nalertname_raw := alertname_raw:string:REGULAR\\\\nemail_address := email_address:string:REGULAR\\\\nldap := ldap:string:REGULAR\\\\nalert := alert:string:REGULAR\\\\ncompany_name := company_name:string:REGULAR\\\\nrep := rep:string:REGULAR\\\\nmanager_email := manager_email:string:REGULAR\\\\n\\(,\\n      \\(children\\( : [ ],\\n      \\(remoteSources\\( : [ ]\\n    }, {\\n      \\(id\\( : \\(507\\(,\\n      \\(name\\( : \\(LocalExchange\\(,\\n      \\(identifier\\( : \\([SINGLE] ()\\(,\\n      \\(details\\( : \\(\\(,\\n      \\(children\\( : [ {\\n        \\(id\\( : \\(415\\(,\\n        \\(name\\( : \\(RemoteSource\\(,\\n        \\(identifier\\( : \\([3]\\(,\\n        \\(details\\( : \\(\\(,\\n        \\(children\\( : [ ],\\n        \\(remoteSources\\( : [ \\(3\\( ]\\n      } ],\\n      \\(remoteSources\\( : [ ]\\n    } ],\\n    \\(remoteSources\\( : [ ]\\n  } ],\\n  \\(remoteSources\\( : [ ]\\n}(},(stageStats(:{(schedulingComplete(:(2022-05-09T12:02:44.921Z(,(getSplitDistribution(:{(count(:1.0,(total(:17353.0,(p01(:17353.0,(p05(:17353.0,(p10(:17353.0,(p25(:17353.0,(p50(:17353.0,(p75(:17353.0,(p90(:17353.0,(p95(:17353.0,(p99(:17353.0,(min(:17353.0,(max(:17353.0,(avg(:17353.0},(getSplitDelayDistribution(:{(count(:1.0,(total(:789669.0,(p01(:789669.0,(p05(:789669.0,(p10(:789669.0,(p25(:789669.0,(p50(:789669.0,(p75(:789669.0,(p90(:789669.0,(p95(:789669.0,(p99(:789669.0,(min(:789669.0,(max(:789669.0,(avg(:789669.0},(totalTasks(:1,(runningTasks(:0,(completedTasks(:1,(totalDrivers(:18,(queuedDrivers(:0,(runningDrivers(:0,(blockedDrivers(:0,(completedDrivers(:18,(cumulativeUserMemory(:1838.0,(userMemoryReservation(:(0B(,(revocableMemoryReservation(:(0B(,(totalMemoryReservation(:(0B(,(peakUserMemoryReservation(:(0B(,(peakRevocableMemoryReservation(:(0B(,(totalScheduledTime(:(936.34us(,(totalCpuTime(:(835.99us(,(totalBlockedTime(:(38.69ms(,(fullyBlocked(:false,(blockedReasons(:[],(physicalInputDataSize(:(0B(,(physicalInputPositions(:0,(physicalInputReadTime(:(0.00ns(,(internalNetworkInputDataSize(:(38B(,(internalNetworkInputPositions(:1,(rawInputDataSize(:(38B(,(rawInputPositions(:1,(processedInputDataSize(:(5B(,(processedInputPositions(:1,(bufferedDataSize(:(0B(,(outputDataSize(:(0B(,(outputPositions(:0,(physicalWrittenDataSize(:(0B(,(gcInfo(:{(stageId(:2,(tasks(:1,(fullGcTasks(:0,(minFullGcSec(:0,(maxFullGcSec(:0,(totalFullGcSec(:0,(averageFullGcSec(:0},(operatorSummaries(:[]},(tasks(:[],(subStages(:[{(stageId(:(20220509_120244_23727_kv48n.3(,(state(:(FINISHED(,(plan(:{(id(:(3(,(root(:{(@type(:(aggregation(,(id(:(5(,(source(:{(@type(:(exchange(,(id(:(530(,(type(:(GATHER(,(scope(:(LOCAL(,(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(max_19(],(replicateNullsAndAny(:false},(sources(:[{(@type(:(remoteSource(,(id(:(536(,(sourceFragmentIds(:[(4(],(outputs(:[(max_19(],(exchangeType(:(GATHER(}],(inputs(:[[(max_19(]]},(aggregations(:{(max(:{(resolvedFunction(:{(signature(:{(name(:(max(,(returnType(:(date(,(argumentTypes(:[(date(]},(id(:(max<e:orderable>(e):e(,(typeDependencies(:{},(functionDependencies(:[{(signature(:{(name(:($operator$COMPARISON(,(returnType(:(integer(,(argumentTypes(:[(date(,(date(]},(id(:($operator$comparison<t:orderable>(t,t):integer(,(typeDependencies(:{},(functionDependencies(:[]}]},(arguments(:[(\\(max_19\\((],(distinct(:false}},(groupingSets(:{(groupingKeys(:[],(groupingSetCount(:1,(globalGroupingSets(:[0]},(preGroupedSymbols(:[],(step(:(FINAL(},(symbols(:{(max(:(date(,(max_19(:(bigint(},(partitioning(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(partitionedSources(:[],(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(FIXED(,(function(:(BROADCAST(}},(arguments(:[]},(outputLayout(:[(max(],(replicateNullsAndAny(:false,(bucketToPartition(:[0]},(stageExecutionDescriptor(:{(strategy(:(UNGROUPED_EXECUTION(,(groupedExecutionScanNodes(:[]},(statsAndCosts(:{(stats(:{},(costs(:{}},(jsonRepresentation(:({\\n  \\(id\\( : \\(5\\(,\\n  \\(name\\( : \\(Aggregate(FINAL)\\(,\\n  \\(identifier\\( : \\(\\(,\\n  \\(details\\( : \\(max := max(\\\\\\(max_19\\\\\\()\\\\n\\(,\\n  \\(children\\( : [ {\\n    \\(id\\( : \\(530\\(,\\n    \\(name\\( : \\(LocalExchange\\(,\\n    \\(identifier\\( : \\([SINGLE] ()\\(,\\n    \\(details\\( : \\(\\(,\\n    \\(children\\( : [ {\\n      \\(id\\( : \\(536\\(,\\n      \\(name\\( : \\(RemoteSource\\(,\\n      \\(identifier\\( : \\([4]\\(,\\n      \\(details\\( : \\(\\(,\\n      \\(children\\( : [ ],\\n      \\(remoteSources\\( : [ \\(4\\( ]\\n    } ],\\n    \\(remoteSources\\( : [ ]\\n  } ],\\n  \\(remoteSources\\( : [ ]\\n}(},(stageStats(:{(schedulingComplete(:(2022-05-09T12:02:44.865Z(,(getSplitDistribution(:{(count(:0.0,(total(:0.0,(p01(:(NaN(,(p05(:(NaN(,(p10(:(NaN(,(p25(:(NaN(,(p50(:(NaN(,(p75(:(NaN(,(p90(:(NaN(,(p95(:(NaN(,(p99(:(NaN(,(min(:(NaN(,(max(:(NaN(,(avg(:(NaN(},(getSplitDelayDistribution(:{(count(:0.0,(total(:0.0,(p01(:(NaN(,(p05(:(NaN(,(p10(:(NaN(,(p25(:(NaN(,(p50(:(NaN(,(p75(:(NaN(,(p90(:(NaN(,(p95(:(NaN(,(p99(:(NaN(,(min(:(NaN(,(max(:(NaN(,(avg(:(NaN(},(totalTasks(:1,(runningTasks(:0,(completedTasks(:1,(totalDrivers(:17,(queuedDrivers(:0,(runningDrivers(:0,(blockedDrivers(:0,(completedDrivers(:17,(cumulativeUserMemory(:509.0,(userMemoryReservation(:(0B(,(revocableMemoryReservation(:(0B(,(totalMemoryReservation(:(0B(,(peakUserMemoryReservation(:(32B(,(peakRevocableMemoryReservation(:(0B(,(totalScheduledTime(:(1.44ms(,(totalCpuTime(:(1.34ms(,(totalBlockedTime(:(1.06s(,(fullyBlocked(:false,(blockedReasons(:[],(physicalInputDataSize(:(0B(,(physicalInputPositions(:0,(physicalInputReadTime(:(0.00ns(,(internalNetworkInputDataSize(:(39B(,(internalNetworkInputPositions(:1,(rawInputDataSize(:(39B(,(rawInputPositions(:1,(processedInputDataSize(:(9B(,(processedInputPositions(:1,(bufferedDataSize(:(0B(,(outputDataSize(:(5B(,(outputPositions(:1,(physicalWrittenDataSize(:(0B(,(gcInfo(:{(stageId(:3,(tasks(:1,(fullGcTasks(:0,(minFullGcSec(:0,(maxFullGcSec(:0,(totalFullGcSec(:0,(averageFullGcSec(:0},(operatorSummaries(:[]},(tasks(:[],(subStages(:[{(stageId(:(20220509_120244_23727_kv48n.4(,(state(:(CANCELED(,(plan(:{(id(:(4(,(root(:{(@type(:(aggregation(,(id(:(534(,(source(:{(@type(:(tablescan(,(id(:(1(,(table(:{(catalogName(:(hive(,(connectorHandle(:{(@type(:(hive(,(schemaName(:(u_ltsins(,(tableName(:(qw_detail(,(partitionColumns(:[],(dataColumns(:[{(@type(:(hive(,(baseColumnName(:(date(,(baseHiveColumnIndex(:0,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep(,(baseHiveColumnIndex(:1,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(rep_first_name(,(baseHiveColumnIndex(:2,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(email_address(,(baseHiveColumnIndex(:3,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(ldap(,(baseHiveColumnIndex(:4,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(merlinrole(,(baseHiveColumnIndex(:5,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(member_id(,(baseHiveColumnIndex(:6,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager(,(baseHiveColumnIndex(:7,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(manager_email(,(baseHiveColumnIndex(:8,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_name(,(baseHiveColumnIndex(:9,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(company_id(,(baseHiveColumnIndex(:10,(baseHiveType(:(bigint(,(baseType(:(bigint(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alertname_raw(,(baseHiveColumnIndex(:11,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert_type(,(baseHiveColumnIndex(:12,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(alert(,(baseHiveColumnIndex(:13,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(},{(@type(:(hive(,(baseColumnName(:(quickwin_category(,(baseHiveColumnIndex(:14,(baseHiveType(:(string(,(baseType(:(varchar(,(columnType(:(REGULAR(}],(compactEffectivePredicate(:{(columnDomains(:[]},(enforcedConstraint(:{(columnDomains(:[]},(transaction(:{(operation(:(NONE(,(transactionId(:0,(writeId(:0}},(transaction(:{(@type(:(hive(,(uuid(:(e297161f-93bc-4984-87db-143be66217bd(}},(outputSymbols(:[(date_0(],(assignments(:{(date_0(:{(@type(:(hive(,(baseColumnName(:(date(,(baseHiveColumnIndex(:0,(baseHiveType(:(date(,(baseType(:(date(,(columnType(:(REGULAR(}},(forDelete(:false},(aggregations(:{(max_19(:{(resolvedFunction(:{(signature(:{(name(:(max(,(returnType(:(date(,(argumentTypes(:[(date(]},(id(:(max<e:orderable>(e):e(,(typeDependencies(:{},(functionDependencies(:[{(signature(:{(name(:($operator$COMPARISON(,(returnType(:(integer(,(argumentTypes(:[(date(,(date(]},(id(:($operator$comparison<t:orderable>(t,t):integer(,(typeDependencies(:{},(functionDependencies(:[]}]},(arguments(:[(\\(date_0\\((],(distinct(:false}},(groupingSets(:{(groupingKeys(:[],(groupingSetCount(:1,(globalGroupingSets(:[0]},(preGroupedSymbols(:[],(step(:(PARTIAL(},(symbols(:{(max_19(:(bigint(,(date_0(:(date(},(partitioning(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SOURCE(,(function(:(UNKNOWN(}},(partitionedSources(:[(1(],(partitioningScheme(:{(partitioning(:{(handle(:{(connectorHandle(:{(@type(:($remote(,(partitioning(:(SINGLE(,(function(:(SINGLE(}},(arguments(:[]},(outputLayout(:[(max_19(],(replicateNullsAndAny(:false,(bucketToPartition(:[0]},(stageExecutionDescriptor(:{(strategy(:(UNGROUPED_EXECUTION(,(groupedExecutionScanNodes(:[]},(statsAndCosts(:{(stats(:{},(costs(:{}},(jsonRepresentation(:({\\n  \\(id\\( : \\(534\\(,\\n  \\(name\\( : \\(Aggregate(PARTIAL)\\(,\\n  \\(identifier\\( : \\(\\(,\\n  \\(details\\( : \\(max_19 := max(\\\\\\(date_0\\\\\\()\\\\n\\(,\\n  \\(children\\( : [ {\\n    \\(id\\( : \\(1\\(,\\n    \\(name\\( : \\(TableScan\\(,\\n    \\(identifier\\( : \\([hive:u_ltsins:qw_detail]\\(,\\n    \\(details\\( : \\(date_0 := date:date:REGULAR\\\\n\\(,\\n    \\(children\\( : [ ],\\n    \\(remoteSources\\( : [ ]\\n  } ],\\n  \\(remoteSources\\( : [ ]\\n}(},(stageStats(:{(schedulingComplete(:(2022-05-09T12:02:44.921Z(,(getSplitDistribution(:{(count(:1.0,(total(:30376.0,(p01(:30376.0,(p05(:30376.0,(p10(:30376.0,(p25(:30376.0,(p50(:30376.0,(p75(:30376.0,(p90(:30376.0,(p95(:30376.0,(p99(:30376.0,(min(:30376.0,(max(:30376.0,(avg(:30376.0},(getSplitDelayDistribution(:{(count(:1.0,(total(:414398.0,(p01(:414398.0,(p05(:414398.0,(p10(:414398.0,(p25(:414398.0,(p50(:414398.0,(p75(:414398.0,(p90(:414398.0,(p95(:414398.0,(p99(:414398.0,(min(:414398.0,(max(:414398.0,(avg(:414398.0},(totalTasks(:1,(runningTasks(:0,(completedTasks(:1,(totalDrivers(:1,(queuedDrivers(:0,(runningDrivers(:0,(blockedDrivers(:0,(completedDrivers(:1,(cumulativeUserMemory(:0.0,(userMemoryReservation(:(0B(,(revocableMemoryReservation(:(0B(,(totalMemoryReservation(:(0B(,(peakUserMemoryReservation(:(0B(,(peakRevocableMemoryReservation(:(0B(,(totalScheduledTime(:(139.90us(,(totalCpuTime(:(138.04us(,(totalBlockedTime(:(0.00ns(,(fullyBlocked(:false,(blockedReasons(:[],(physicalInputDataSize(:(0B(,(physicalInputPositions(:0,(physicalInputReadTime(:(0.00ns(,(internalNetworkInputDataSize(:(0B(,(internalNetworkInputPositions(:0,(rawInputDataSize(:(0B(,(rawInputPositions(:0,(processedInputDataSize(:(0B(,(processedInputPositions(:0,(bufferedDataSize(:(0B(,(outputDataSize(:(9B(,(outputPositions(:1,(physicalWrittenDataSize(:(0B(,(gcInfo(:{(stageId(:4,(tasks(:1,(fullGcTasks(:0,(minFullGcSec(:0,(maxFullGcSec(:0,(totalFullGcSec(:0,(averageFullGcSec(:0},(operatorSummaries(:[]},(tasks(:[],(subStages(:[],(tables(:{(1(:{(tableName(:(hive.u_ltsins.qw_detail(,(predicate(:{(columnDomains(:[]}}}}],(tables(:{}}],(tables(:{(0(:{(tableName(:(hive.u_ltsins.qw_detail(,(predicate(:{(columnDomains(:[]}}}}],(tables(:{}}],(tables(:{}},(warnings(:[],(inputs(:[{(catalogName(:(hive(,(schema(:(u_ltsins(,(table(:(qw_detail(,(columns(:[{(name(:(alert(,(type(:(varchar(},{(name(:(manager_email(,(type(:(varchar(},{(name(:(manager(,(type(:(varchar(},{(name(:(alertname_raw(,(type(:(varchar(},{(name(:(ldap(,(type(:(varchar(},{(name(:(rep(,(type(:(varchar(},{(name(:(alert_type(,(type(:(varchar(},{(name(:(quickwin_category(,(type(:(varchar(},{(name(:(email_address(,(type(:(varchar(},{(name(:(company_name(,(type(:(varchar(},{(name(:(member_id(,(type(:(bigint(},{(name(:(company_id(,(type(:(bigint(},{(name(:(merlinrole(,(type(:(varchar(},{(name(:(date(,(type(:(date(}],(fragmentId(:(2(,(planNodeId(:(0(},{(catalogName(:(hive(,(schema(:(u_ltsins(,(table(:(qw_detail(,(columns(:[{(name(:(date(,(type(:(date(}],(fragmentId(:(4(,(planNodeId(:(1(}],(output(:{(catalogName(:(hive(,(schema(:(u_ltsins(,(table(:(alert_details(},(referencedTables(:[{(catalog(:(hive(,(schema(:(u_ltsins(,(table(:(qw_detail(,(authorization(:(ltsins(,(filters(:[],(columns(:[{(column(:(manager(,(masks(:[]},{(column(:(member_id(,(masks(:[]},{(column(:(date(,(masks(:[]},{(column(:(email_address(,(masks(:[]},{(column(:(alert(,(masks(:[]},{(column(:(alert_type(,(masks(:[]},{(column(:(quickwin_category(,(masks(:[]},{(column(:(company_id(,(masks(:[]},{(column(:(ldap(,(masks(:[]},{(column(:(manager_email(,(masks(:[]},{(column(:(company_name(,(masks(:[]},{(column(:(rep(,(masks(:[]},{(column(:(merlinrole(,(masks(:[]},{(column(:(alertname_raw(,(masks(:[]}]},{(catalog(:(hive(,(schema(:(u_ltsins(,(table(:(qw_detail(,(authorization(:(ltsins(,(filters(:[],(columns(:[{(column(:(date(,(masks(:[]}]}],(routines(:[{(routine(:(day_of_week(,(authorization(:(ltsins(},{(routine(:(max(,(authorization(:(ltsins(},{(routine(:(concat(,(authorization(:(ltsins(}],(resourceGroupId(:[(global(,(adhoc_ltsins(],(queryType(:(INSERT(,(finalQueryInfo(:true}'", 1);

        for (int i = 0; i < threadCount; i++) {
            executorService.submit(
                    // asynchronous call to cancel query which will be stared via `assertFailedQuery` below
                    () -> {
//                        Session querySession = Session.builder(new SessionPropertyManager()).setQueryId(new QueryId(String.format(queryIdTemplate, i))).build();
                        getQueryRunner().execute(querySession, "SELECT regexp_replace(veryLongStr, 'List\\((.*,)+(.*\\))', 'List\\($2\\)') as requesttarget FROM testTable");
                    });
        }
        Thread.sleep(5000);
        executorService.shutdownNow();

        while(true);
    }
}
